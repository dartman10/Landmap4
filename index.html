<!DOCTYPE html>
<html>
<head>
	<title>LORDLANDER</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
  <script src="https://unpkg.com/embeddable-nfts/dist/nft-card.min.js"></script>
	<style>
		html, body {
			height: 100%;
			margin: 10%;
		}
		#map {
			width: 800px;
			height: 600px;
		}
	</style>	
</head>

<body>

<div id='map'></div>

<script>

	var map = L.map('map', {   //what is "L"?  where does that come from? is that a Leaflet object?
		crs: L.CRS.Simple,
		minZoom: -3
	});

	var yx = L.latLng;

	var xy = function(x, y) {
		if (L.Util.isArray(x)) {    // When doing xy([x, y]);
			return yx(x[1], x[0]);
		}
		return yx(y, x);  // When doing xy(x, y);
	};

	var bounds = [xy(0, 0), xy(1023, 1021.5)];
  var image = L.imageOverlay('sandbox_map.png', bounds).addTo(map);
  
  var centerY = 504.973 //500.457 // 98.185;  //longitude (y) of center of universe
  var centerX = 546.716 //544.455 // 98.585;  //latitude (x) of center of universe

  var yHeight = 2.258;  //height of box
  var xLength = 2.261;  //width of box
 
  //center of metaverse
  L.polygon([[centerY, centerX],   // longitude, latitude
             [centerY, centerX],
             [centerY, centerX],
             [centerY, centerX]
            ], {color: 'red', fillColor: '#f03',fillOpacity: 1}
           ).addTo(map);

  var positionY;  // Y coordinate mapping of Sandbox Y to LandMap Y 
  var positionX;  // X coordinate mapping of Sandbox X to LandMap

  map.setView(yx(centerY, centerX), 0.8);  // this is the initial coordinates view of the map

  // On click event - variable and function
  var popup_01 = L.popup();
  function onMapClick(e) {                //function for click event; calls popup
        popup_01
            .setLatLng(e.latlng)
            .setContent(sandboxLink)
            .openOn(map);
  }

  function drawBox(positionY, positionX) {     //render one piece of land
    L.polygon([
            [centerY + (yHeight * positionY) - (yHeight / 2 ), centerX + (xLength * positionX) - (xLength / 2)],   // longitude, latitude
            [centerY + (yHeight * positionY) + (yHeight / 2 ), centerX + (xLength * positionX) - (xLength / 2)],
            [centerY + (yHeight * positionY) + (yHeight / 2 ), centerX + (xLength * positionX) + (xLength / 2)],
            [centerY + (yHeight * positionY) - (yHeight / 2 ), centerX + (xLength * positionX) + (xLength / 2)]
    ], {color: 'red', fillColor: '#f03',fillOpacity: 0.5}).addTo(map).on('click',onMapClick);
  }

  //go left
  drawBox(0,-25);
  drawBox(0,-50);
  drawBox(0,-75);
  drawBox(0,-100);
  drawBox(0,-125);
  drawBox(0,-150);
  drawBox(0,-175);

  //go right
  drawBox(0,25);
  drawBox(0,50);
  drawBox(0,75);
  drawBox(0,100);
  drawBox(0,125);
  drawBox(0,150);
  drawBox(0,175);

  //go up
  drawBox(25,0);
  drawBox(50,0);
  drawBox(75,0);
  drawBox(100,0);
  drawBox(125,0);
  drawBox(150,0);
  drawBox(175,0);
  drawBox(185,0);

  //go down
  drawBox(-25,0);
  drawBox(-50,0);
  drawBox(-75,0);
  drawBox(-100,0);
  drawBox(-125,0);
  drawBox(-150,0);
  drawBox(-175,0);
  drawBox(-185,0);

  drawBox(2,1) ;

  var sandboxLink; 
  //sandboxLink = '<nft-card contractAddress="0x50f5474724e0ee42d9a4e711ccfb275809fd6d4a" tokenId="22073"></nft-card>'; drawBox(-147,-178);  //remember (y,x) --> this is mapped to SandBox lot x = -163, y = -150
  sandboxLink = '<nft-card contractAddress="0x50f5474724e0ee42d9a4e711ccfb275809fd6d4a" tokenId="22073"></nft-card>'; drawBox(-147,-178);
  sandboxLink = '<nft-card contractAddress="0x50f5474724e0ee42d9a4e711ccfb275809fd6d4a" tokenId="118652"></nft-card>'; drawBox(89,113);

// Set the following three variables when calling drawBox
//   x  -->  calculated x coordinate based on Sandbox asset trait X
//   y  -->  calculated y coordinate based on Sandbox asset trait y
//   sandboxLink  -->  Opensea link pointing to a Sandbox land asset
// Idea : Make the Python script produce javascript code lines with the hardcoded values.
//        Then just include them right here.
// Javascript line will look like this:
// x = aValue; y = aValue; sandboxLink = aValue; drawbox(x,y);

   // ---- cut and past all generated string here -- //


</script>

</body>
</html>